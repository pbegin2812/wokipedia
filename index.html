<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Wokipédia — Encyclopédie des joueurs fictifs</title>
  <!-- Icône d’onglet -->
  <link rel="icon" type="image/png" href="assets/Lettre _W_ en noir et blanc.png">

  <style>
    :root{--bg:#fff;--muted:#6b6b6b;--accent:#1765c1;--card:#fbfdff}
    body{font-family:Inter,Segoe UI,Arial,Helvetica,sans-serif;margin:0;background:var(--bg);color:#111}
    header{background:#f4f7fb;padding:18px 24px;border-bottom:1px solid #e6eef9}
    .wrap{max-width:1100px;margin:20px auto;padding:0 20px}
    h1{margin:0;font-size:24px}
    .searchbar{margin-top:12px;display:flex;gap:8px}
    input[type=search]{flex:1;padding:10px 12px;border:1px solid #d9e4f5;border-radius:6px;font-size:15px}
    button{padding:10px 12px;border-radius:6px;border:0;background:var(--accent);color:#fff;cursor:pointer}
    .layout{display:grid;grid-template-columns:320px 1fr;gap:20px;margin-top:20px}
    .sidebar{background:var(--card);padding:14px;border-radius:8px;border:1px solid #e9f0fb}
    .player-list{list-style:none;padding:0;margin:0}
    .player-list li{padding:8px 6px;border-bottom:1px solid #f0f5fb;cursor:pointer}
    .player-list li:hover{background:#f7fbff}
    .content{background:#fff;padding:18px;border-radius:8px;border:1px solid #eef6ff;min-height:420px}
    .card-header{display:flex;gap:12px;align-items:center}
    .avatar{width:96px;height:128px;background:#eee;border-radius:4px;overflow:hidden}
    .avatar img{width:100%;height:100%;object-fit:cover}
    .meta{flex:1}
    table{border-collapse:collapse;width:100%;margin-top:12px}
    td,th{padding:6px 8px;border:1px solid #f0f5fb}
    .muted{color:var(--muted);font-size:14px}
    .controls{display:flex;gap:8px;margin-top:12px}
    .form{margin-top:14px;padding:12px;border-radius:8px;background:#fbfdff;border:1px solid #eef6ff}
    label{display:block;font-size:13px;margin:6px 0 2px}
    input,textarea,select{width:100%;padding:8px;border:1px solid #dfeaf9;border-radius:6px}
    @media (max-width:900px){.layout{grid-template-columns:1fr}.sidebar{order:2}}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Wokipédia — Encyclopédie des joueurs fictifs</h1>
      <div class="searchbar">
        <input id="search" type="search" placeholder="Rechercher un joueur (ex : Palinho, Parkson)..." oninput="renderList()">
        <button onclick="openAdd()">Ajouter un joueur</button>
      </div>
    </div>
  </header>

  <div class="wrap layout">
    <aside class="sidebar">
      <h3>Joueurs</h3>
      <ul id="list" class="player-list" role="listbox" tabindex="0"></ul>
      <div class="muted" style="margin-top:12px">Clique sur un joueur pour voir sa page. Tu peux ajouter et modifier des fiches.</div>
    </aside>

    <section class="content" id="detail">
      <div class="muted">Sélectionne un joueur dans la colonne de gauche ou recherche par nom.</div>
    </section>
  </div>

  <!-- Form modal -->
  <div id="formbox" style="display:none;position:fixed;inset:0;background:rgba(10,20,40,0.45);align-items:center;justify-content:center;padding:20px">
    <div style="background:#fff;padding:16px;border-radius:10px;max-width:720px;width:100%">
      <h3>Ajouter / Modifier un joueur</h3>
      <div class="form">
        <label>Nom complet</label><input id="fn">
        <label>Pseudo</label><input id="pn">
        <label>Date de naissance</label><input id="dob" placeholder="JJ/MM/AAAA">
        <label>Lieu de naissance</label><input id="birth">
        <label>Nationalités (séparées par des virgules)</label><input id="nats">
        <label>Poste</label><input id="pos">
        <label>Carrière (format CSV: période|club|matchs|buts)</label>
        <textarea id="career" rows="4"></textarea>
        <label>Image</label>
        <input type="file" id="uploadImg" accept="image/*">
        <img id="preview" style="max-width:120px;margin-top:8px;display:block">

        <div style="display:flex;gap:8px;margin-top:10px">
          <button onclick="savePlayer()">Enregistrer</button>
          <button onclick="closeForm()" style="background:#eee;color:#111">Annuler</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Données initiales
    const players = {
      "Palinho":{
        fullname:"Agani Parkson",
        pseudo:"Palinho",
        dob:"30/07/1992",
        birth:"London, England",
        nats:["Philippines","United Kingdom","United States","Oman","Brazil","Spain (2014)"],
        pos:"Attaquant",
        image:"",
        career:[
          ["2009–2010","Southampton","22","7"],
          ["2010–2014","Hull City","61","20"],
          ["2011–2012","→ Manchester United (prêt)","15","5"],
          ["2012–2013","→ Corinthians (prêt)","27","12"],
          ["2013–2014","→ Inter (prêt)","24","9"],
          ["2014–2015","Fulham","30","11"],
          ["2015–2020","Chelsea","71","26"],
          ["2016–2018","→ Lecce (prêt)","59","23"],
          ["2020–2022","Lecce","63","25"],
          ["2022–2025","Frencia FC (Citronie)","92","41"]
        ],
        totals:{matches:484,goals:179}
      }
    };

    // Charger depuis localStorage
    const saved = localStorage.getItem("wokipediaPlayers");
    if (saved) {
      Object.assign(players, JSON.parse(saved));
    }

    function saveToStorage() {
      localStorage.setItem("wokipediaPlayers", JSON.stringify(players));
    }

    function renderList(){
      const q = document.getElementById('search').value.trim().toLowerCase();
      const list = document.getElementById('list');
      list.innerHTML = '';
      Object.keys(players).filter(k=>k.toLowerCase().includes(q) || players[k].fullname.toLowerCase().includes(q)).sort().forEach(name=>{
        const li = document.createElement('li');
        li.textContent = name + ' — ' + (players[name].pseudo||'');
        li.onclick = ()=>showPlayer(name);
        list.appendChild(li);
      });
      if(list.children.length===0){
        const li = document.createElement('li'); li.textContent='Aucun joueur trouvé'; li.style.color='#888'; list.appendChild(li);
      }
    }

    function showPlayer(key){
      const p = players[key];
      const container = document.getElementById('detail');
      container.innerHTML = '';
      const header = document.createElement('div'); header.className='card-header';
      const avatar = document.createElement('div'); avatar.className='avatar';
      const img = document.createElement('img'); img.src = p.image || '';
      avatar.appendChild(img);
      const meta = document.createElement('div'); meta.className='meta';
      meta.innerHTML = `<h2>${key} <span style="font-size:14px;color:#666">(${p.fullname})</span></h2>
                        <div class="muted">${p.pos} • Né(e) ${p.dob} • ${p.birth}</div>`;
      header.appendChild(avatar); header.appendChild(meta);
      container.appendChild(header);

      const t = document.createElement('table');
      t.innerHTML = '<thead><tr><th>Période</th><th>Club</th><th>Matchs</th><th>Buts</th></tr></thead>';
      const tb = document.createElement('tbody');
      p.career.forEach(row=>{
        const tr = document.createElement('tr');
        row.forEach(c=>{ const td=document.createElement('td'); td.textContent=c; tr.appendChild(td); });
        tb.appendChild(tr);
      });
      t.appendChild(tb);
      container.appendChild(t);

      const tot = document.createElement('div'); 
      tot.style.marginTop='12px'; 
      tot.innerHTML=`<strong>Totaux :</strong> ${p.totals.matches} matchs — ${p.totals.goals} buts`;
      container.appendChild(tot);

      const controls = document.createElement('div'); controls.className='controls';
      const btnEdit = document.createElement('button'); btnEdit.textContent='Modifier'; btnEdit.onclick=()=>openEdit(key);
      controls.appendChild(btnEdit);
      container.appendChild(controls);
    }

    function openAdd(){
      document.getElementById('formbox').style.display='flex';
      clearForm();
    }
    function openEdit(key){
      document.getElementById('formbox').style.display='flex';
      const p = players[key];
      document.getElementById('fn').value = p.fullname || '';
      document.getElementById('pn').value = key || '';
      document.getElementById('dob').value = p.dob || '';
      document.getElementById('birth').value = p.birth || '';
      document.getElementById('nats').value = (p.nats||[]).join(', ');
      document.getElementById('pos').value = p.pos || '';
      document.getElementById('preview').src = p.image || '';
      document.getElementById('career').value = (p.career||[]).map(r=>r.join('|')).join('\n');
    }
    function clearForm(){ 
      document.getElementById('fn').value='';
      document.getElementById('pn').value='';
      document.getElementById('dob').value='';
      document.getElementById('birth').value='';
      document.getElementById('nats').value='';
      document.getElementById('pos').value='';
      document.getElementById('career').value='';
      document.getElementById('preview').src='';
    }
    function closeForm(){ document.getElementById('formbox').style.display='none'; }

    // Upload preview
    document.getElementById('uploadImg').addEventListener('change', e => {
      const file = e.target.files[0];
      if(file){
        const url = URL.createObjectURL(file);
        document.getElementById('preview').src = url;
        document.getElementById('preview').dataset.tempUrl = url;
      }
    });

    function savePlayer(){
      const key = document.getElementById('pn').value.trim();
      if(!key){ alert('Le pseudo est requis (ex: Palinho)'); return; }
      const p = {
        fullname: document.getElementById('fn').value.trim(),
        pseudo: key,
        dob: document.getElementById('dob').value.trim(),
        birth: document.getElementById('birth').value.trim(),
        nats: document.getElementById('nats').value.split(',').map(s=>s.trim()).filter(Boolean),
        pos: document.getElementById('pos').value.trim(),
        image: document.getElementById('preview').src || '',
        career: document.getElementById('career').value.split('\n').map(l=>l.split('|').map(s=>s.trim())).filter(r=>r.length>=4),
      };
      let matches=0, goals=0; 
      p.career.forEach(r=>{ matches+=parseInt(r[2])||0; goals+=parseInt(r[3])||0 });
      p.totals={matches,goals};
      players[key]=p;
      saveToStorage();
      closeForm(); renderList(); showPlayer(key);
    }

    renderList();
  </script>
</body>
</html>
